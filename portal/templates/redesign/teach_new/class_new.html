{% extends 'redesign/teach_new/base_class_edit.html' %}
{% load staticfiles %}
{% load app_tags %}

{% block css %}
{{ block.super }}
<link href='{% static "portal/css/jquery-ui.css" %}' rel="stylesheet">
{% endblock css %}

{% block scripts %}
{{ block.super }}
<script type="text/javascript" src="{% static 'portal/js/teach_class.js' %}"></script>
<script type="text/javascript" src="{% static 'portal/js/common.js' %}"></script>
<script type="text/javascript" src="{% static 'portal/js/lib/jquery-ui.js' %}"></script>
<script>
    var CLASS_CODE = "{{ class.access_code }}";
    var DELETE_STUDENTS_URL = "{% url 'teacher_delete_students_new' class.access_code %}";

    var CONFIRMATION_DATA = {
        'deleteClass': {
            options: {
                title: 'Delete class'
            },
            html: '<p class="body-text">This class will be permanently deleted. Are you sure?</p>',
            confirm: function() { window.location.replace("{% url 'teacher_delete_class_new' class.access_code %}"); }
        },
        'deleteStudents': {
            options: {
                title: 'Delete students'
            },
            html: '<p class="body-text">These students will be permanently deleted. Are you sure?</p>',
            confirm: function() { postSelectedStudents(DELETE_STUDENTS_URL); }
        }
    };
</script>
{% endblock scripts %}

{% block pageID %}id='homeWrapper'{% endblock %}

{% block content %}
{{ block.super }}

<div id="teach_class_page"></div>

<section class="background">
    <h2>{{ user|make_into_username }}, {{ class.name }} ({{ class.access_code }})</h2>
    <h4 class="col-sm-6 col-center">Here you can view and manage all of your students within each of your classes. We&rsquo;ve created reminder cards which includes each
        students login details for you to print out, meaning they won&rsquo;t forget and you don&rsquo;t have to remember this for them. You can add new students, transfer
        existing students to another one of your classes or to another teacher within your school or club, or remove students altogether.</h4>
</section>

<div class="background col-sm-8 col-center">
    <div class="row">
        <div class="col-sm-6">
            <h3>Current students</h3>
            <p class="body-text">Select an individual student to change their details, including their name and password.</p>
            <p class="body-text">Select multiple students using the checkboxes to reset their passwords, move them to another class, release them from your school and
                make them an independent Code for Life user, or delete them permanently.</p>
        </div>
        <div class="col-sm-6">
            <table id="student_table" class="student-table header-secondary data-quaternary">
                <tr class="student-table__header">
                    <th class="cell-center">
                        <p class="body-text">Select</p>
                        <div class="student-table__cell">
                            <input id='selectedStudentsListToggle' name='selectedStudentsListToggle' type="checkbox" value="">
                            <p class="small-text">Select all</p>
                        </div>
                    </th>
                    <th><p class="body-text">Student details</p></th>
                    <th>
                        <p class="body-text">Status</p>
                        <div class="student-table__cell"><div class="student-status student-status--online"></div><p class="small-text">Logged in</p></div>
                        <div class="student-table__cell"><div class="student-status student-status--offline"></div><p class="small-text">Logged out</p></div>
                    </th>
                </tr>
                {% for student in students %}
                <tr>
                    <td class="cell-center"><input id="student_checkbox" type="checkbox" class='student' name='{{ student.id }}' value=""></td>
                    <td>
                        <div class="student-table__cell">
                            <p class="small-text">{{ student.new_user.first_name }}</p>
                            <a id="edit_student_button" href="{% url 'teacher_edit_student_new' student.id %}" class="button--small button--primary--positive">Edit</a>
                        </div>
                    </td>
                    <td>
                        {% if student.logged_in %}<div class="student-status student-status--online"></div>
                        {% else %}<div class="student-status student-status--offline"></div>{% endif %}
                    </td>
                </tr>
                {% endfor %}
                <tr>
                    <td class="table-footer" colspan="3" rowspan="2">
                        <p class="small-text"><span id="num_students_selected">0</span>/{{ num_students }} selected</p>
                        <button class="button--small button--primary--navigation">Move</button>
                        <button class="button--small button--primary--navigation">Release</button>
                        <button id="deleteSelectedStudents" class="button--small button--primary--danger">Delete</button>
                        <button class="button--small button--primary--danger">Reset passwords</button>
                    </td>
                </tr>
            </table>
        </div>
    </div>
    <p class="body-text"><a href="{% url 'dashboard' %}#classes">&#10229; Back to Classes</a></p>
</div>

<div class="background background--quaternary">
    <div class="col-sm-8 col-center">
        <div class="row">
            <div class="col-sm-6">
                <h3>Add new students</h3>
                <p class="body-text">Add the students&rsquo; names to the box below with one student name per line. Students&rsquo; names will be used in their login
                    details, and so each name should be unique.</p>
                <p class="body-text">You have the option to use students&rsquo; first names only, or first and last names. Students&rsquo; names and the class access code
                    are required to sign in.</p>
            </div>
            <div class="col-sm-6">
                <form id='form-create-students' method='POST'>

                    {% csrf_token %}

                    {{ new_students_form.non_field_errors }}

                    {{ new_students_form.names.errors }}
                    {{ new_students_form.names }}

                    <button type='submit' class='button--regular button--primary--positive' name='new_students' value='Add students'>Add students</button>
                </form>
            </div>
        </div>
    </div>
</div>

<div class="background col-sm-8 col-center">
    <h3>Edit other class settings</h3>
    <p class="body-text">Here you may change the name of the class, transfer the class to another teacher in the school or club, create permissions for the class to
        accept requests from external students, or delete classes for which there are no students. You can also create permissions for students in this class to see
        their classmates&rsquo; progress.</p>
    <div class="background button-group">
        <a id="class_settings_button" href="{% url 'teacher_edit_class_new' class.access_code %}" class="button--regular button--primary--positive">Edit settings</a>
        <button id='deleteClass' class="button--regular button--primary--danger">Delete class</button>
    </div>
    <p class="body-text"><a href="{% url 'dashboard' %}#classes">&#10229; Back to Classes</a></p>
</div>

{% endblock content %}
